# Milesight AM300 LoRaWAN Decoder

## Device Information
- **Manufacturer**: Milesight
- **Model**: AM300 Series (AM300/AM307/AM308/AM319)
- **Type**: Indoor Air Quality Monitor
- **LoRaWAN Version**: 1.0.3
- **Regions**: EU868, US915, AS923, AU915, IN865, RU864, KR920
- **Official Reference**: https://www.milesight-iot.com/lorawan/sensor/am300/

## Implementation Details
- **Driver Version**: 1.4.0
- **Generated**: 2025-09-02
- **Coverage**: 20/20 uplinks implemented, 5/5 downlinks implemented
- **Framework**: v2.5.0
- **Template**: v2.5.0

## Expected UI Examples

### Example 1: Normal Air Quality
```
┌─────────────────────────────────────┐
│ 🏠 AM300-slot2  Milesight AM300     │
│ 🔋 3.8V 📶 -75dBm ⏱️ 2m ago        │
├─────────────────────────────────────┤
│ 🌡️ 23.2°C 💧 45% 🔵 1013hPa 💡 7/10│
│ 💨 420ppm 🌬️ 0.7 ⚠️ 0.06mg/m³     │
│ 🌫️ 15μg/m³ 🌫️ 22μg/m³ 🌊 0.005ppm  │
│ 🏠 Vacant 🟢 Excellent ✅ WELL OK   │
└─────────────────────────────────────┘
```

### Example 2: Occupied with Poor Air Quality
```
┌─────────────────────────────────────┐
│ 🏠 AM300-slot2  Milesight AM300     │
│ 🔋 3.6V 📶 -82dBm ⏱️ 1m ago        │
├─────────────────────────────────────┤
│ 🌡️ 26.5°C 💧 65% 🔵 1008hPa 💡 8/10│
│ 💨 1200ppm 🌬️ 3.5 ⚠️ 0.18mg/m³    │
│ 🌫️ 85μg/m³ 🌫️ 120μg/m³ 🌊 0.025ppm │
│ 🚶 Occupied 🔴 Poor ❌ WELL Alert   │
└─────────────────────────────────────┘
```

### Example 3: Alert with Buzzer
```
┌─────────────────────────────────────┐
│ 🏠 AM300-slot2  Milesight AM300     │
│ 🔋 3.4V 📶 -88dBm ⏱️ 30s ago       │
├─────────────────────────────────────┤
│ 🌡️ 28.8°C 💧 75% 🔵 995hPa 💡 9/10 │
│ 💨 1800ppm 🌬️ 4.8 ⚠️ 0.32mg/m³    │
│ 🌫️ 150μg/m³ 🌫️ 180μg/m³ 🌊 0.045ppm│
│ 🚶 Occupied 🚨 Unhealthy 🔔 Buzzer ON│
└─────────────────────────────────────┘
```

## Command Reference

### Test Commands (slot = driver slot 1-16):
| Command | Description | Usage | Example |
|---------|-------------|-------|---------|
| LwAM300TestUI<slot> | UI scenarios | `<scenario>` | `LwAM300TestUI2 normal` |

### Control Commands (slot = driver slot 1-16):
| Command | Description | Usage | Downlink Hex |
|---------|-------------|-------|---------------|
| LwAM300Interval<slot> | Set interval | `<minutes>` | `FF01XXXX` |
| LwAM300Buzzer<slot> | Buzzer control | `on/off` | `FF0EXX` |
| LwAM300Screen<slot> | Screen control | `on/off` | `FF2DXX` |
| LwAM300TimeSync<slot> | Sync time | (no params) | `FF02XXXXXXXX` |
| LwAM300Reboot<slot> | Device reboot | (no params) | `FF10` |

## Usage Examples

### Driver in Slot 2:
```bash
# Test realistic scenarios 
LwAM300TestUI2 normal      # Normal air quality
LwAM300TestUI2 occupied    # Occupied space
LwAM300TestUI2 poor        # Poor air quality
LwAM300TestUI2 excellent   # Excellent conditions
LwAM300TestUI2 alert       # Alert conditions

# Control device
LwAM300Interval2 20        # Set 20-minute reporting
LwAM300Buzzer2 on          # Enable buzzer alarms
LwAM300Screen2 off         # Turn off e-ink display
LwAM300TimeSync2           # Sync device time
LwAM300Reboot2             # Restart device
```

## Uplink Coverage Matrix
| Channel | Type | Description | Status | Notes |
|---------|------|-------------|--------|-------|
| 0x01 | 0x75 | Battery | ✅ Implemented | Percentage |
| 0x03 | 0x67 | Temperature | ✅ Implemented | ±0.1°C |
| 0x04 | 0x68 | Humidity | ✅ Implemented | ±2% RH |
| 0x05 | 0x02 | PIR Motion | ✅ Implemented | Occupied/Vacant |
| 0x06 | 0xCB/0x10 | Light Level | ✅ Implemented | 0-10 scale |
| 0x07 | 0x7D | CO2 | ✅ Implemented | 400-5000ppm |
| 0x08 | 0x7D/0xE6 | TVOC | ✅ Implemented | Level/PPB |
| 0x09 | 0x73 | Pressure | ✅ Implemented | hPa |
| 0x0A | 0x7D | HCHO | ✅ Implemented | mg/m³ |
| 0x0B | 0x7D | PM2.5 | ✅ Implemented | μg/m³ |
| 0x0C | 0x7D | PM10 | ✅ Implemented | μg/m³ |
| 0x0D | 0x7D | O3 | ✅ Implemented | ppm |
| 0x0E | 0x01 | Buzzer Status | ✅ Implemented | On/Off |
| 0x0F | 0x01 | Activity Event | ✅ Implemented | Movement |
| 0x10 | 0x01 | Power Event | ✅ Implemented | Power-on |
| 0xFF | 0x0B | Device Info | ✅ Implemented | Config response |

## Decoded Parameters
| Parameter | Unit | Range | Notes |
|-----------|------|-------|-------|
| battery_pct | % | 0 to 100 | Battery percentage |
| temperature | °C | -40 to 85 | ±0.1°C accuracy |
| humidity | %RH | 0 to 100 | ±2% accuracy |
| pir_occupancy | boolean | - | Motion detection |
| light_level | level | 0 to 10 | Illumination scale |
| co2_ppm | ppm | 400 to 5000 | NDIR sensor |
| tvoc_level | IAQ | 0 to 5 | Air quality index |
| tvoc_ppb | ppb | 0 to 65000 | Concentration |
| pressure_hpa | hPa | 300 to 1100 | Barometric |
| hcho_mgm3 | mg/m³ | 0 to 6 | Formaldehyde |
| pm25_ugm3 | μg/m³ | 0 to 1000 | Fine particles |
| pm10_ugm3 | μg/m³ | 0 to 1000 | Coarse particles |
| o3_ppm | ppm | 0 to 10 | Ozone |
| air_quality_status | string | - | Calculated status |
| well_status | boolean | - | WELL compliance |

## Air Quality Features
- **Smart Status**: Calculated from CO2, TVOC, and PM2.5 levels
- **WELL Compliance**: Building standard verification
- **9-in-1 Sensors**: Complete environmental monitoring
- **E-ink Display**: Real-time air quality visualization
- **Threshold Alarms**: Configurable via downlinks
- **Data Logging**: Historical data with retransmission

## Changelog
```
- v1.4.0 (2025-09-02): Template v2.5.0 upgrade with TestUI payload verification
- v1.3.0 (2025-09-02): Framework v2.4.1 upgrade with critical Berry keys() fixes
- v1.2.0 (2025-08-26): Enhanced display with air quality status
- v1.1.0 (2025-08-20): Added multi-sensor support and WELL features
- v1.0.0 (2025-08-14): Initial generation from MAP specification
```